
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>é»é¤ç³»çµ±</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-database-compat.js"></script>
  <script src="script.js"></script>
</head>
<body>
  <div class="top-bar">
    <button onclick="switchMode('edit')">ç·¨è¼¯æ¨¡å¼</button>
    <button onclick="showMenuSelector()">é¸æ“‡èœå–®</button>
  </div>

  <div id="menuSelector" style="display:none; text-align:center; margin-top:20px;">
    <label for="menuPicker">è«‹é¸æ“‡èœå–®ï¼š</label>
    <select id="menuPicker" onchange="loadAndStartOrder()">
      <option disabled selected>è¼‰å…¥ä¸­...</option>
    </select>
  </div>

  <div id="order-mode" class="section">
    <div id="category-buttons"></div>
    <div id="menu"></div>
    <div class="order-list">
      <h2>ğŸ§¾ è¨‚å–®æ˜ç´°</h2>
      <ul id="orderList"></ul>
      <p id="totalPrice">ç¸½é‡‘é¡ï¼š$0</p>
      <button class="button" onclick="submitOrder()">âœ… é€å‡ºè¨‚å–®</button>
    </div>
  </div>

  <div id="edit-mode" class="section" style="display:none;">
    <h2>ğŸ“‹ ç·¨è¼¯åˆ†é¡</h2>
    <input type="text" id="newCategory" placeholder="åˆ†é¡åç¨±" />
    <input type="color" id="categoryColor" value="#ffcc00" />
    <button onclick="addCategory()">æ–°å¢åˆ†é¡</button>
    <ul id="categoryList"></ul>

    <h2>ğŸ½ï¸ ç·¨è¼¯é¤é»</h2>
    <input type="text" id="itemName" placeholder="é¤é»åç¨±" />
    <select id="itemCategory"></select>
    <input type="number" id="itemPrice" placeholder="ä¸€èˆ¬åƒ¹æ ¼" />
    <input type="number" id="itemLargePrice" placeholder="å¤§ä»½åƒ¹æ ¼" />
    <button onclick="addItem()">æ–°å¢é¤é»</button>
    <ul id="menuList"></ul>

    <h2>â˜ï¸ èœå–®å„²å­˜/è¼‰å…¥</h2>
    <input type="text" id="menuName" placeholder="èœå–®åç¨±" />
    <button onclick="saveMenu()">å„²å­˜èœå–®</button>
    <select id="savedMenus" onchange="loadMenu(this.value)">
      <option value="">--é¸æ“‡å·²å„²å­˜èœå–®--</option>
    </select>
    <button onclick="deleteMenu()">åˆªé™¤èœå–®</button>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBY2JkCQErm8pyh2B1uCZmeuDohi8DNces",
      authDomain: "order-game-3a2c3.firebaseapp.com",
      databaseURL: "https://order-game-3a2c3-default-rtdb.firebaseio.com",
      projectId: "order-game-3a2c3",
      storageBucket: "order-game-3a2c3.appspot.com",
      messagingSenderId: "793590994015",
      appId: "1:793590994015:web:d089bf8bea249a3837f7ea"
    };
    
    window.onload = () => {
      // è‡ªå‹•åˆå§‹åŒ–ä¸‹æ‹‰æ¸…å–®ï¼ˆéç«‹å³é¡¯ç¤ºï¼‰
      const picker = document.getElementById("menuPicker");
      firebase.database().ref("menus").once("value", snapshot => {
        picker.innerHTML = "";
        snapshot.forEach(child => {
          const opt = document.createElement("option");
          opt.value = child.key;
          opt.textContent = child.key;
          picker.appendChild(opt);
        });
      });
    };

    function showMenuSelector() {
      document.getElementById("menuSelector").style.display = "block";
    }

      document.getElementById("menuSelector").style.display = "block";
      const picker = document.getElementById("menuPicker");
      picker.innerHTML = "<option disabled selected>è¼‰å…¥ä¸­...</option>";
      firebase.database().ref("menus").once("value", snapshot => {
        picker.innerHTML = "";
        snapshot.forEach(child => {
          const opt = document.createElement("option");
          opt.value = child.key;
          opt.textContent = child.key;
          picker.appendChild(opt);
        });
      });
    }

    function loadAndStartOrder() {
      const name = document.getElementById("menuPicker").value;
      loadMenu(name);
      switchMode("order");
    }
  </script>
</body>
</html>
