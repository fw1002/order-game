<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>點餐遊戲 v6</title>
  <style>
    body { font-family: sans-serif; margin: 0; background-color: #f5f5f5; }
    .top-bar { background: #333; padding: 10px; text-align: center; }
    .top-bar button { color: white; background: #555; border: none; padding: 10px 20px; margin: 0 10px; cursor: pointer; }
    .section { padding: 20px; }
    .menu-item { border: 1px solid #ccc; background: #fff; padding: 10px; margin: 10px; display: inline-block; width: 200px; }
    .order-list { margin-top: 20px; }
    .order-list li { margin: 5px 0; }
    .button { padding: 5px 10px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="top-bar">
    <button onclick="switchMode('order')">開始點餐</button>
    <button onclick="switchMode('edit')">編輯模式</button>
  </div>
  <div id="order-mode" class="section">
    <h2>點餐畫面</h2>
    <div id="menu"></div>
    <div class="order-list">
      <h3>已點項目</h3>
      <ul id="orderList"></ul>
      <p id="totalPrice">總金額：$0</p>
      <button class="button" onclick="submitOrder()">送出訂單</button>
    </div>
  </div>

  <div id="edit-mode" class="section" style="display:none">
    <h2>編輯模式</h2>
    <input type="text" id="itemName" placeholder="餐點名稱">
    <input type="number" id="itemPrice" placeholder="價格">
    <button onclick="addItem()">新增餐點</button>
    <ul id="menuList"></ul>
  </div>

  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBY2JkCQErm8pyh2B1uCZmeuDohi8DNces",
      authDomain: "order-game-3a2c3.firebaseapp.com",
      databaseURL: "https://order-game-3a2c3-default-rtdb.firebaseio.com",
      projectId: "order-game-3a2c3",
      storageBucket: "order-game-3a2c3.firebasestorage.app",
      messagingSenderId: "793590994015",
      appId: "1:793590994015:web:d089bf8bea249a3837f7ea"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let menuItems = [];
    let order = [];

    function switchMode(mode) {
      document.getElementById('order-mode').style.display = mode === 'order' ? 'block' : 'none';
      document.getElementById('edit-mode').style.display = mode === 'edit' ? 'block' : 'none';
      if (mode === 'order') renderMenu();
      else renderMenuList();
    }

    function renderMenu() {
      const menuDiv = document.getElementById('menu');
      menuDiv.innerHTML = '';
      menuItems.forEach((item, i) => {
        const div = document.createElement('div');
        div.className = 'menu-item';
        div.innerHTML = `
          <strong>${item.name}</strong><br>
          價格：$${item.price}<br>
          <button class="button" onclick="addToOrder(${i})">加入</button>`;
        menuDiv.appendChild(div);
      });
    }

    function renderMenuList() {
      const ul = document.getElementById('menuList');
      ul.innerHTML = '';
      menuItems.forEach((item, i) => {
        const li = document.createElement('li');
        li.innerHTML = `${item.name} - $${item.price}`;
        ul.appendChild(li);
      });
    }

    function addItem() {
      const name = document.getElementById('itemName').value;
      const price = parseInt(document.getElementById('itemPrice').value);
      if (name && price) {
        menuItems.push({ name, price });
        renderMenuList();
      }
    }

    function addToOrder(index) {
      const item = menuItems[index];
      order.push(item);
      renderOrder();
    }

    function renderOrder() {
      const ul = document.getElementById('orderList');
      ul.innerHTML = '';
      let total = 0;
      order.forEach(item => {
        total += item.price;
        const li = document.createElement('li');
        li.textContent = `${item.name} - $${item.price}`;
        ul.appendChild(li);
      });
      document.getElementById('totalPrice').textContent = `總金額：$${total}`;
    }

    function submitOrder() {
      if (order.length === 0) return alert('請先加入餐點');
      db.ref('orders').push({ items: order, time: new Date().toISOString() });
      alert('訂單已送出');
      order = [];
      renderOrder();
    }

    switchMode('order');
  </script>
</body>
</html>
